#!/usr/bin/env python

# TODO: merge with oio-xcute-server

import signal
from optparse import OptionParser

from oio.common.configuration import parse_options, read_conf
from oio.xcute.common.orchestrator import XcuteOrchestrator


if __name__ == '__main__':
    parser = OptionParser('%prog CONFIG [options]')
    conf_file, options = parse_options(parser)
    conf = read_conf(conf_file, 'xcute-server')

    orchestrator = XcuteOrchestrator(conf, verbose=options['verbose'])

    signal.signal(signal.SIGINT, orchestrator.exit_gracefully)
    signal.signal(signal.SIGTERM, orchestrator.exit_gracefully)

    orchestrator.run_forever()
